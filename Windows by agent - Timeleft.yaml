zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: e3d531482747463490e0aecdd561b031
      name: 'Custom Template - COMPASS'
    - uuid: ef3d66c9934e4f6fb66ab74a01c069f3
      name: Templates/GodFather
    - uuid: 846977d1dfed4968bc5f8bdb363285bc
      name: 'Templates/Operating systems'
  templates:
    - uuid: 0e661cbd94da4fe9a7de1304106ea714
      template: 'Custom - Windows by Zabbix agent - GodFather'
      name: 'Custom - Windows by Zabbix agent - GodFather'
      templates:
        - name: 'Custom - ICMP Ping - GodFather'
      groups:
        - name: 'Custom Template - COMPASS'
        - name: Templates/GodFather
        - name: 'Templates/Operating systems'
      items:
        - uuid: f886e7916e7f47118e349484cb53546b
          name: 'Host name of Zabbix agent running'
          key: agent.hostname
          delay: 1h
          value_type: CHAR
          trends: '0'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 2b5b684da9444025ac1692d23ef52d7c
          name: 'Zabbix agent ping'
          key: agent.ping
          description: 'The agent always returns "1" for this item. May be used in combination with `nodata()` for the availability check.'
          valuemap:
            name: 'Zabbix agent ping status'
          tags:
            - tag: component
              value: system
        - uuid: 90815cc8bb7a4b0cbd2ff9a1ce4bbb53
          name: 'Version of Zabbix agent running'
          key: agent.version
          delay: 1h
          value_type: CHAR
          trends: '0'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: application
        - uuid: cba45e4f9b3d4fd2a58bd82bd51c848e
          name: 'Cache bytes'
          key: 'perf_counter_en["\Memory\Cache Bytes"]'
          units: B
          description: 'Cache Bytes is the sum of the Memory\\System Cache Resident Bytes, Memory\\System Driver Resident Bytes, Memory\\System Code Resident Bytes, and Memory\\Pool Paged Resident Bytes counters. This counter displays the last observed value only; it is not an average.'
          tags:
            - tag: component
              value: memory
        - uuid: 642942760f5d4a1b9e556c1e9b534b8b
          name: 'Free system page table entries'
          key: 'perf_counter_en["\Memory\Free System Page Table Entries"]'
          description: 'This indicates the number of page table entries not currently in use by the system. If the number is less than 5,000, there may be a memory leak or you running out of memory.'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: c0d36044b9a14403a10314741f400db6
              expression: 'max(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\Memory\Free System Page Table Entries"],5m)<{$MEM.PAGE_TABLE_CRIT.MIN}'
              name: 'Windows: Number of free system page table entries is too low'
              event_name: 'Windows: Number of free system page table entries is too low (less {$MEM.PAGE_TABLE_CRIT.MIN} for 5m)'
              status: DISABLED
              priority: WARNING
              description: '`Memory\Free System Page Table Entries` has been less than `{$MEM.PAGE_TABLE_CRIT.MIN}` for 5 minutes. If the number is less than 5,000, there may be a memory leak.'
              tags:
                - tag: scope
                  value: capacity
        - uuid: 07f9102efecb46d2bdb5332be198274f
          name: 'Memory page faults per second'
          key: 'perf_counter_en["\Memory\Page Faults/sec"]'
          value_type: FLOAT
          description: 'Page Faults/sec is the average number of pages faulted per second. It is measured in number of pages faulted per second because only one page is faulted in each fault operation, hence this is also equal to the number of page fault operations. This counter includes both hard faults (those that require disk access) and soft faults (where the faulted page is found elsewhere in physical memory.) Most processors can handle large numbers of soft faults without significant consequence. However, hard faults, which require disk access, can cause significant delays.'
          tags:
            - tag: component
              value: memory
        - uuid: 968e52723be246bcba7d34e9503a1cef
          name: 'Memory pages per second'
          key: 'perf_counter_en["\Memory\Pages/sec"]'
          value_type: FLOAT
          description: |
            This measures the rate at which pages are read from or written to disk to resolve hard page faults.
            If the value is greater than 1,000, as a result of excessive paging, there may be a memory leak.
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: f0c92f725ebd480f9ff061cbeb34bff0
              expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\Memory\Pages/sec"],5m)>{$MEM.PAGE_SEC.CRIT.MAX}'
              name: 'Windows: The Memory Pages/sec is too high'
              event_name: 'Windows: The Memory Pages/sec is too high (over {$MEM.PAGE_SEC.CRIT.MAX} for 5m)'
              priority: WARNING
              description: 'The Memory Pages/sec in the last 5 minutes exceeds `{$MEM.PAGE_SEC.CRIT.MAX}`. If the value is greater than 1,000, as a result of excessive paging, there may be a memory leak.'
              tags:
                - tag: scope
                  value: capacity
        - uuid: 53ab9cd1547743dfb36d882fed6e6b06
          name: 'Memory pool non-paged'
          key: 'perf_counter_en["\Memory\Pool Nonpaged Bytes"]'
          units: B
          description: |
            This measures the size, in bytes, of the non-paged pool. This is an area of system memory for objects that cannot be written to disk but instead must remain in physical memory as long as they are allocated.
            There is a possible memory leak if the value is greater than 175MB (or 100MB with the /3GB switch). Consequently, Event ID 2019 is recorded in the system event log.
          tags:
            - tag: component
              value: memory
        - uuid: 875280d34d8e40188dc8cf9b1f21b3d0
          name: 'Used swap space in %'
          key: 'perf_counter_en["\Paging file(_Total)\% Usage"]'
          value_type: FLOAT
          units: '%'
          description: 'The used space of swap volume/file in percent.'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: 39c697d9074d42a7b999b71c4796b668
          name: 'CPU DPC time'
          key: 'perf_counter_en["\Processor Information(_total)\% DPC Time"]'
          value_type: FLOAT
          units: '%'
          description: 'Processor DPC time is the time that a single processor spent receiving and servicing deferred procedure calls (DPCs). DPCs are interrupts that run at a lower priority than standard interrupts. `% DPC Time` is a component of `% Privileged Time` because DPCs are executed in privileged mode. If a high `% DPC Time` is sustained, there may be a processor bottleneck or an application or hardware related issue that can significantly diminish overall system performance.'
          tags:
            - tag: component
              value: cpu
        - uuid: 29d49eb95b254d548265cf2c2e0502fa
          name: 'CPU interrupt time'
          key: 'perf_counter_en["\Processor Information(_total)\% Interrupt Time"]'
          value_type: FLOAT
          units: '%'
          description: 'The processor information `% Interrupt Time` counter indicates how much time the processor spends handling hardware interrupts during sample intervals. It reflects the activity of devices like the system clock, mouse, disk drivers, and network cards. A value above 20% suggests possible hardware issues.'
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: 2c25f48e0a504c149c80ae4c3f18175b
              expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\Processor Information(_total)\% Interrupt Time"],5m)>{$CPU.INTERRUPT.CRIT.MAX}'
              name: 'Windows: CPU interrupt time is too high'
              event_name: 'Windows: CPU interrupt time is too high (over {$CPU.INTERRUPT.CRIT.MAX}% for 5m)'
              status: DISABLED
              priority: WARNING
              description: 'The CPU Interrupt Time in the last 5 minutes exceeds `{$CPU.INTERRUPT.CRIT.MAX}`%.'
              tags:
                - tag: scope
                  value: performance
        - uuid: 41edbfe6b860474c8401969693759f59
          name: 'CPU privileged time'
          key: 'perf_counter_en["\Processor Information(_total)\% Privileged Time"]'
          value_type: FLOAT
          units: '%'
          description: 'The processor information `% Privileged Time` counter shows the percent of time that the processor is spent executing in Kernel (or Privileged) mode. Privileged mode includes services interrupts inside Interrupt Service Routines (ISRs), executing Deferred Procedure Calls (DPCs), Device Driver calls and other kernel-mode functions of the Windows Operating System.'
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: 9615611d207241fea7a17f06bd22291b
              expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\Processor Information(_total)\% Privileged Time"],5m)>{$CPU.PRIV.CRIT.MAX}'
              name: 'Windows: CPU privileged time is too high'
              event_name: 'Windows: CPU privileged time is too high (over {$CPU.PRIV.CRIT.MAX}% for 5m)'
              status: DISABLED
              priority: WARNING
              description: 'The CPU privileged time in the last 5 minutes exceeds {$CPU.PRIV.CRIT.MAX}%.'
              dependencies:
                - name: 'Windows: CPU interrupt time is too high'
                  expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\Processor Information(_total)\% Interrupt Time"],5m)>{$CPU.INTERRUPT.CRIT.MAX}'
              tags:
                - tag: scope
                  value: performance
        - uuid: 91bd3c3eda284ca9b9344c57af5f9894
          name: 'CPU user time'
          key: 'perf_counter_en["\Processor Information(_total)\% User Time"]'
          value_type: FLOAT
          units: '%'
          description: 'The processor information `% User Time` counter shows the percent of time that the processor(s) is spent executing in User mode.'
          tags:
            - tag: component
              value: cpu
        - uuid: d8bbf486e9624e7796a359e163138dd7
          name: 'Context switches per second'
          key: 'perf_counter_en["\System\Context Switches/sec"]'
          value_type: FLOAT
          description: |
            Context Switches/sec is the combined rate at which all processors on the computer are switched from one thread to another.
            Context switches occur when a running thread voluntarily relinquishes the processor, is preempted by a higher priority ready thread, or switches between user-mode and privileged (kernel) mode to use an Executive or subsystem service.
            It is the sum of Thread\\Context Switches/sec for all threads running on all processors in the computer and is measured in numbers of switches.
            There are context switch counters on the System and Thread objects. This counter displays the difference between the values observed in the last two samples, divided by the duration of the sample interval.
          tags:
            - tag: component
              value: cpu
        - uuid: f2cf42521c6b4ca98c1b3ce80f0e54be
          name: 'CPU queue length'
          key: 'perf_counter_en["\System\Processor Queue Length"]'
          value_type: FLOAT
          description: 'The Processor Queue Length shows the number of threads that are observed as delayed in the processor Ready Queue and are waiting to be executed.'
          tags:
            - tag: component
              value: cpu
        - uuid: 6b426bd8dee6443792d3eb0e60bccc5c
          name: 'Number of threads'
          key: 'perf_counter_en["\System\Threads"]'
          description: 'The number of threads used by all running processes.'
          tags:
            - tag: component
              value: os
        - uuid: 2e15526ff16f4fc1aa0c16924ce1df29
          name: 'Number of processes'
          key: 'proc.num[]'
          description: 'The number of processes.'
          tags:
            - tag: component
              value: os
        - uuid: b8ee25a05a774b04bdc70cbd9b35566b
          name: 'Status do servico Qualys Cloud Agent'
          key: 'service.info["QualysAgent",state]'
          valuemap:
            name: 'Windows service state'
          tags:
            - tag: service
              value: qualys
        - uuid: ede90d6192c9489194f90d19451f8874
          name: 'Status do servico ds_agent'
          key: 'service.info[ds_agent,state]'
          valuemap:
            name: 'Windows service state'
          tags:
            - tag: service
              value: ds_agent
        - uuid: 2846323f389249ec83e2936664b194d5
          name: 'CPU utilization'
          key: system.cpu.util
          value_type: FLOAT
          units: '%'
          description: 'CPU utilization expressed in %.'
          tags:
            - tag: component
              value: cpu
          triggers:
            - uuid: 011228b9b6214368839bb7a53a1b584d
              expression: 'min(/Custom - Windows by Zabbix agent - GodFather/system.cpu.util,{$TIME:"CPU"})>{$CPU.UTIL.CRIT}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'min(/Custom - Windows by Zabbix agent - GodFather/system.cpu.util,{$TIME:"CPU"})<{$CPU.UTIL.CRIT}'
              name: 'Windows: CPU acima do limite {$CPU.UTIL.CRIT}% ({$TIME:"CPU"})'
              priority: HIGH
            - uuid: f2bb3ce880264c8199402dda5717d438
              expression: 'min(/Custom - Windows by Zabbix agent - GodFather/system.cpu.util,{$TIME:"CPU"})>{$CPU.UTIL.WARN}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'min(/Custom - Windows by Zabbix agent - GodFather/system.cpu.util,{$TIME:"CPU"})<{$CPU.UTIL.WARN}'
              name: 'Windows: CPU acima do limite {$CPU.UTIL.WARN}% ({$TIME:"CPU"})'
              priority: AVERAGE
        - uuid: f0ecfae1f0b44beca3e2d82c16e9025a
          name: 'System name'
          key: system.hostname
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: 'The host name of the system.'
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: ffbf8332263a4259b9983d221be5d723
              expression: 'change(/Custom - Windows by Zabbix agent - GodFather/system.hostname) and length(last(/Custom - Windows by Zabbix agent - GodFather/system.hostname))>0'
              name: 'Windows: System name has changed'
              event_name: 'Windows: System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 0495a92639b84836a072342f58cb1160
          name: 'System local time'
          key: system.localtime
          delay: 15m
          units: unixtime
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 86bd4a95f2674106a472004b79d9f1c4
              expression: 'fuzzytime(/Custom - Windows by Zabbix agent - GodFather/system.localtime,{$SYSTEM.FUZZYTIME.MAX})=0'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'fuzzytime(/Custom - Windows by Zabbix agent - GodFather/system.localtime,{$SYSTEM.FUZZYTIME.MIN})=1'
              name: 'Windows: System time is out of sync'
              event_name: 'Windows: System time is out of sync (diff with Zabbix server > {$SYSTEM.FUZZYTIME.MAX})'
              priority: AVERAGE
              description: 'The host''s system time is different from Zabbix server time.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 025c058142d649debd14264c1d3e62ee
          name: 'Operating system architecture'
          key: system.sw.arch
          delay: 12h
          value_type: CHAR
          trends: '0'
          description: 'The architecture of the operating system.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
        - uuid: db07c0e6304d466ea89e41bc969d0b4f
          name: 'Operating system'
          key: system.sw.os
          delay: 12h
          value_type: CHAR
          trends: '0'
          inventory_link: OS
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: os
          triggers:
            - uuid: 0b07f35a53d74343a58cdefb3a542a4c
              expression: 'change(/Custom - Windows by Zabbix agent - GodFather/system.sw.os) and length(last(/Custom - Windows by Zabbix agent - GodFather/system.sw.os))>0'
              name: 'Windows: Operating system description has changed'
              priority: INFO
              description: 'The description of the operating system has changed. Possible reasons are that the system has been updated or replaced. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Windows: System name has changed'
                  expression: 'change(/Custom - Windows by Zabbix agent - GodFather/system.hostname) and length(last(/Custom - Windows by Zabbix agent - GodFather/system.hostname))>0'
              tags:
                - tag: scope
                  value: notice
        - uuid: 5d85f70b5aeb44b1976b66c72a097c05
          name: 'Free swap space'
          type: CALCULATED
          key: system.swap.free
          units: B
          params: 'last(//system.swap.size[,total]) - last(//system.swap.size[,total]) / 100 * last(//perf_counter_en["\Paging file(_Total)\% Usage"])'
          description: 'The free space of the swap volume/file expressed in bytes.'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: 4eb13fafd6894fa78599062d76c973c0
          name: 'Free swap space in %'
          type: DEPENDENT
          key: system.swap.pfree
          delay: '0'
          value_type: FLOAT
          units: '%'
          description: 'The free space of the swap volume/file expressed in %.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return (100 - value)'
          master_item:
            key: 'perf_counter_en["\Paging file(_Total)\% Usage"]'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: e681d951572d46908bd2b7f2f37ae756
          name: 'Total swap space'
          key: 'system.swap.size[,total]'
          delay: 10m
          units: B
          description: 'The total space of the swap volume/file expressed in bytes.'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: 97a600ed045a4014ad3a71441f4d75d7
          name: 'System description'
          key: system.uname
          delay: 1h
          value_type: CHAR
          trends: '0'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: component
              value: system
        - uuid: 59d793feb5ba46dc9ef81d9f274a5f23
          name: Uptime
          key: system.uptime
          delay: 30s
          trends: '0'
          units: uptime
          description: 'The system uptime expressed in the following format: "N days, hh:mm:ss".'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 58b9a06d095d4147ab2cb36af397aa63
              expression: 'last(/Custom - Windows by Zabbix agent - GodFather/system.uptime)<10m'
              name: 'Windows: Host has been restarted'
              event_name: 'Windows: Host has been restarted (uptime < 10m)'
              priority: WARNING
              description: 'The device uptime is less than 10 minutes.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
        - uuid: 4212b50b6693475a8a4f113e61e83005
          name: 'Get filesystems'
          key: vfs.fs.get
          history: '0'
          value_type: TEXT
          trends: '0'
          description: 'The `vfs.fs.get` key acquires raw information set about the filesystems. Later to be extracted by preprocessing in dependent items.'
          tags:
            - tag: component
              value: raw
        - uuid: 07ea004dc33049d6800c2c78549e286c
          name: 'Total memory'
          key: 'vm.memory.size[total]'
          delay: 1h
          units: B
          description: 'Total memory expressed in bytes.'
          tags:
            - tag: component
              value: memory
        - uuid: 1624f59da5ff40ff80a1fce56f7d43ac
          name: 'Used memory'
          key: 'vm.memory.size[used]'
          units: B
          description: 'Used memory in bytes.'
          tags:
            - tag: component
              value: memory
        - uuid: d9435b29fc314d9a936e0b2ea5edbddd
          name: 'Memory utilization'
          type: CALCULATED
          key: vm.memory.util
          value_type: FLOAT
          units: '%'
          params: 'last(//vm.memory.size[used]) / last(//vm.memory.size[total]) * 100'
          description: 'Memory utilization in %.'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: c20002c9d4754365bdb77e0e66e963d9
              expression: 'min(/Custom - Windows by Zabbix agent - GodFather/vm.memory.util,{$TIME:"MEMORIA"})>{$MEMORY.UTIL.MAX}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'min(/Custom - Windows by Zabbix agent - GodFather/vm.memory.util,{$TIME:"MEMORIA"})<{$MEMORY.UTIL.MAX}'
              name: 'Windows: Memória acima do limite {$MEMORY.UTIL.MAX}% ({$TIME:"MEMORIA"})'
              priority: HIGH
            - uuid: fab6bba78c7e4d5dbad69280bf9789c1
              expression: 'min(/Custom - Windows by Zabbix agent - GodFather/vm.memory.util,{$TIME:"MEMORIA"})>{$MEMORY.UTIL.WARN}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'min(/Custom - Windows by Zabbix agent - GodFather/vm.memory.util,{$TIME:"MEMORIA"})<{$MEMORY.UTIL.WARN}'
              name: 'Windows: Memória acima do limite {$MEMORY.UTIL.WARN}% ({$TIME:"MEMORIA"})'
              priority: AVERAGE
        - uuid: 5cd9fba9faba40a08d4f4c144f57ad4d
          name: 'Windows: Network interfaces WMI get'
          key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
          history: '0'
          value_type: TEXT
          trends: '0'
          description: 'Raw data of `win32_networkadapter.`'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: component
              value: raw
        - uuid: a29cedef987542ccb095517575e0d5b3
          name: 'Number of cores'
          key: 'wmi.get[root/cimv2,"Select NumberOfLogicalProcessors from Win32_ComputerSystem"]'
          delay: 1h
          description: 'The number of logical processors available on the computer.'
          tags:
            - tag: component
              value: cpu
        - uuid: f05fa7f8d8a840f9bc345628c6929cae
          name: 'Zabbix agent availability'
          type: INTERNAL
          key: 'zabbix[host,agent,available]'
          description: 'Used for monitoring the availability status of the agent.'
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 5a3ee8470b4e486f96056ed98d1cd1f0
              expression: 'max(/Custom - Windows by Zabbix agent - GodFather/zabbix[host,agent,available],{$AGENT.TIMEOUT})=0'
              name: 'Windows: Zabbix agent is not available'
              event_name: 'Windows: Zabbix agent is not available (for {$AGENT.TIMEOUT})'
              priority: HIGH
              description: 'For passive agents only, host availability is used with `{$AGENT.TIMEOUT}` as a time threshold.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: d4f6e98c58b546ce955c94688ec755b3
          name: 'Network interfaces discovery'
          type: DEPENDENT
          key: net.if.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: A
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: C
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: E
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
          description: 'Discovery of installed network interfaces.'
          item_prototypes:
            - uuid: 0c65a3d9b3b445309ea4da7407e8fdcd
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              key: 'net.if.in["{#IFGUID}",dropped]'
              delay: 3m
              description: 'The number of incoming packets dropped on the network interface.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 3e8919f2078b464bb2f98f1facc6134f
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              key: 'net.if.in["{#IFGUID}",errors]'
              delay: 3m
              description: 'The number of incoming packets with errors on the network interface.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 84fd6c05219e4b25a0817e50192199d0
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              key: 'net.if.in["{#IFGUID}"]'
              delay: 3m
              units: bps
              description: 'Incoming traffic on the network interface.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: dbb0991049d649838c48ef1a8e527088
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              key: 'net.if.out["{#IFGUID}",dropped]'
              delay: 3m
              description: 'The number of outgoing packets dropped on the network interface.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 852e5d312dd645e49308c758eac2d95d
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              key: 'net.if.out["{#IFGUID}",errors]'
              delay: 3m
              description: 'The number of outgoing packets with errors on the network interface.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 73613220d6d142c1bda550984d71e988
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              key: 'net.if.out["{#IFGUID}"]'
              delay: 3m
              units: bps
              description: 'Outgoing traffic on the network interface.'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 7bc205ad33594423b091ddeaa4e04b4e
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: DEPENDENT
              key: 'net.if.speed["{#IFGUID}"]'
              delay: '0'
              trends: '0'
              units: bps
              description: 'Estimated bandwidth of the network interface if any.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[?(@.GUID == "{#IFGUID}")].Speed.first()'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: JAVASCRIPT
                  parameters:
                    - 'return (value==''9223372036854775807'' ? 0 : value)'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: b698bd2972c84f4094063a4bb4014aee
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: DEPENDENT
              key: 'net.if.status["{#IFGUID}"]'
              delay: '0'
              trends: '0'
              description: 'The operational status of the network interface.'
              valuemap:
                name: 'Win32_NetworkAdapter::NetConnectionStatus'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[?(@.GUID == "{#IFGUID}")].NetConnectionStatus.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: ea4e5a2b89424311b0804a5e9e499de3
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])<>2 and (last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#1)<>last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Windows: Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important.
                    No new trigger will be fired if this interface is down.
                    3. `last(/TEMPLATE_NAME/METRIC,#1)<>last(/TEMPLATE_NAME/METRIC,#2)` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for the 'eternal off' interfaces.)
                    
                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 39d60c50c97a4c7eaf8d2112cd650bf1
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: DEPENDENT
              key: 'net.if.type["{#IFGUID}"]'
              delay: '0'
              trends: '0'
              description: 'The type of the network interface.'
              valuemap:
                name: 'Win32_NetworkAdapter::AdapterTypeId'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$[?(@.GUID == "{#IFGUID}")].AdapterTypeId.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: f424a8c946854026be6d5511db993fbb
              expression: |
                change(/Custom - Windows by Zabbix agent - GodFather/net.if.speed["{#IFGUID}"])<0 and
                last(/Custom - Windows by Zabbix agent - GodFather/net.if.speed["{#IFGUID}"])>0 and
                last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])=2
              name: 'Windows: Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Windows: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])<>2 and (last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#1)<>last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#2))'
                  recovery_expression: 'last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: capacity
            - uuid: 30745e2a44bf4f1eb689d7df6e993a62
              expression: |
                (avg(/Custom - Windows by Zabbix agent - GodFather/net.if.in["{#IFGUID}"],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Custom - Windows by Zabbix agent - GodFather/net.if.speed["{#IFGUID}"]) or
                avg(/Custom - Windows by Zabbix agent - GodFather/net.if.out["{#IFGUID}"],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Custom - Windows by Zabbix agent - GodFather/net.if.speed["{#IFGUID}"])) and
                last(/Custom - Windows by Zabbix agent - GodFather/net.if.speed["{#IFGUID}"])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Custom - Windows by Zabbix agent - GodFather/net.if.in["{#IFGUID}"],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Custom - Windows by Zabbix agent - GodFather/net.if.speed["{#IFGUID}"]) and
                avg(/Custom - Windows by Zabbix agent - GodFather/net.if.out["{#IFGUID}"],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Custom - Windows by Zabbix agent - GodFather/net.if.speed["{#IFGUID}"])
              name: 'Windows: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'Windows: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'Windows: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])<>2 and (last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#1)<>last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#2))'
                  recovery_expression: 'last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: b05b5c644fd747f19a69657d063aee99
              expression: |
                min(/Custom - Windows by Zabbix agent - GodFather/net.if.in["{#IFGUID}",errors],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Custom - Windows by Zabbix agent - GodFather/net.if.out["{#IFGUID}",errors],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Custom - Windows by Zabbix agent - GodFather/net.if.in["{#IFGUID}",errors],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Custom - Windows by Zabbix agent - GodFather/net.if.out["{#IFGUID}",errors],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Windows: Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'Windows: Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: 'Windows: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])<>2 and (last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#1)<>last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"],#2))'
                  recovery_expression: 'last(/Custom - Windows by Zabbix agent - GodFather/net.if.status["{#IFGUID}"])=2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: availability
          graph_prototypes:
            - uuid: bafaff31236d4b2ca3886532b10e3b84
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'net.if.in["{#IFGUID}"]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: F63100
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'net.if.out["{#IFGUID}"]'
                - sortorder: '2'
                  color: 00611C
                  yaxisside: RIGHT
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'net.if.out["{#IFGUID}",errors]'
                - sortorder: '3'
                  color: F7941D
                  yaxisside: RIGHT
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'net.if.in["{#IFGUID}",errors]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'net.if.out["{#IFGUID}",dropped]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'net.if.in["{#IFGUID}",dropped]'
          master_item:
            key: 'wmi.getall[root\cimv2,"select Name,Description,NetConnectionID,Speed,AdapterTypeId,NetConnectionStatus,GUID from win32_networkadapter where PhysicalAdapter=True and NetConnectionStatus>0"]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  output = JSON.parse(value).map(function(net){
                  	return {
                  		"{#IFNAME}": net.Name,
                  		"{#IFDESCR}": net.Description,
                  		"{#IFALIAS}": net.NetConnectionID,
                  		"{#IFGUID}": net.GUID
                  	}})
                  return JSON.stringify({"data": output})
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 4f52e64826274411bd7809013a11b45d
          name: 'Physical disks discovery'
          key: 'perf_instance_en.discovery[PhysicalDisk]'
          delay: 6h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.MATCHES}'
                formulaid: A
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          item_prototypes:
            - uuid: 459a0578c4ff4e008d5722147f5158de
              name: '{#DEVNAME}: Disk utilization by idle time'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\% Idle Time",60]'
              value_type: FLOAT
              units: '%'
              description: 'This item is the percentage of elapsed time that the selected disk drive was busy servicing read or writes requests based on idle time.'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return (100 - value)'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                - uuid: c491a62cdc39472fb71cc7c7da0ddc4e
                  expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\PhysicalDisk({#DEVNAME})\% Idle Time",60],15m)>{$VFS.DEV.UTIL.MAX.WARN}'
                  name: 'Windows: {#DEVNAME}: Disk is overloaded'
                  event_name: 'Windows: {#DEVNAME}: Disk is overloaded (util > {$VFS.DEV.UTIL.MAX.WARN}% for 15m)'
                  priority: WARNING
                  description: 'The disk appears to be under heavy load.'
                  manual_close: 'YES'
                  dependencies:
                    - name: 'Windows: {#DEVNAME}: Disk read request responses are too high'
                      expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read",60],15m) > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"}'
                    - name: 'Windows: {#DEVNAME}: Disk write request responses are too high'
                      expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write",60],15m) > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"}'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: e5a8349f9340483a8b79d4db10c00e46
              name: '{#DEVNAME}: Average disk read queue length'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Read Queue Length",60]'
              value_type: FLOAT
              description: 'Average disk read queue, the number of requests outstanding on the disk at the time the performance data is collected.'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: 8a22922d0ced4e489a7ddf166037376e
              name: '{#DEVNAME}: Disk read request avg waiting time'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read",60]'
              value_type: FLOAT
              units: s
              description: 'The average time for read requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                - uuid: 437a9310edad4cddaa52e2c4ee062d25
                  expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read",60],15m) > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"}'
                  name: 'Windows: {#DEVNAME}: Disk read request responses are too high'
                  event_name: 'Windows: {#DEVNAME}: Disk read request responses are too high (read > {$VFS.DEV.READ.AWAIT.WARN:"{#DEVNAME}"}s for 15m)'
                  priority: WARNING
                  description: 'This trigger might indicate the disk {#DEVNAME} saturation.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: 759fd71688a042c78084c98f949d1cb5
              name: '{#DEVNAME}: Disk write request avg waiting time'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write",60]'
              value_type: FLOAT
              units: s
              description: 'The average time for write requests issued to the device to be served. This includes the time spent by the requests in queue and the time spent servicing them.'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
              trigger_prototypes:
                - uuid: d329e622cdb14e4dbe67df8ebe196a91
                  expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write",60],15m) > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"}'
                  name: 'Windows: {#DEVNAME}: Disk write request responses are too high'
                  event_name: 'Windows: {#DEVNAME}: Disk write request responses are too high (write > {$VFS.DEV.WRITE.AWAIT.WARN:"{#DEVNAME}"}s for 15m)'
                  priority: WARNING
                  description: 'This trigger might indicate the disk {#DEVNAME} saturation.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: aa3b404d394b4f7ba23d559185043b81
              name: '{#DEVNAME}: Average disk write queue length'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Write Queue Length",60]'
              value_type: FLOAT
              description: 'Average disk write queue, the number of requests outstanding on the disk at the time the performance data is collected.'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: c25a5629e58842fdb5ad3f0dd807702a
              name: '{#DEVNAME}: Disk average queue size (avgqu-sz)'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Current Disk Queue Length",60]'
              value_type: FLOAT
              description: 'The current average disk queue; the number of requests outstanding on the disk while the performance data is being collected.'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: 9f185de7063642819f27192c1e5f759f
              name: '{#DEVNAME}: Disk read rate'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Reads/sec",60]'
              value_type: FLOAT
              units: '!r/s'
              description: 'Rate of read operations on the disk.'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: 4b9e0cb1c577404bbcffbc5b38da51fa
              name: '{#DEVNAME}: Disk write rate'
              key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Writes/sec",60]'
              value_type: FLOAT
              units: '!w/s'
              description: 'Rate of write operations on the disk.'
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
          graph_prototypes:
            - uuid: 271340850e94459f8884b4aaddc52212
              name: '{#DEVNAME}: Disk average queue length'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Read Queue Length",60]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk Write Queue Length",60]'
            - uuid: 97ca0a7df0a640ecb84beea5fcfe8718
              name: '{#DEVNAME}: Disk average waiting time'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Read",60]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Avg. Disk sec/Write",60]'
            - uuid: 8414b3acec034c6798beeba8f24ac29b
              name: '{#DEVNAME}: Disk read/write rates'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Reads/sec",60]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Disk Writes/sec",60]'
            - uuid: a4a9247f657f4bb6828edbdcd2f7dd23
              name: '{#DEVNAME}: Disk utilization and queue'
              graph_items:
                - color: 199C0D
                  yaxisside: RIGHT
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\Current Disk Queue Length",60]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'perf_counter_en["\PhysicalDisk({#DEVNAME})\% Idle Time",60]'
          preprocessing:
            - type: STR_REPLACE
              parameters:
                - '{#INSTANCE}'
                - '{#DEVNAME}'
        - uuid: 2d22e31cdeb6487c8e9dc80d1ec1d149
          name: 'Windows services discovery'
          key: service.discovery
          delay: 6h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#SERVICE.NAME}'
                value: '{$SERVICE.NAME.MATCHES}'
                formulaid: A
              - macro: '{#SERVICE.NAME}'
                value: '{$SERVICE.NAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#SERVICE.STARTUPNAME}'
                value: '{$SERVICE.STARTUPNAME.MATCHES}'
                formulaid: C
              - macro: '{#SERVICE.STARTUPNAME}'
                value: '{$SERVICE.STARTUPNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          lifetime_type: DELETE_IMMEDIATELY
          lifetime: '0'
          item_prototypes:
            - uuid: 02df5c8e26d444819b34a6eba5dbb1f4
              name: 'State of service "{#SERVICE.NAME}" ({#SERVICE.DISPLAYNAME})'
              key: 'service.info["{#SERVICE.NAME}",state]'
              valuemap:
                name: 'Windows service state'
              tags:
                - tag: component
                  value: system
                - tag: name
                  value: '{#SERVICE.DISPLAYNAME}'
                - tag: service
                  value: '{#SERVICE.NAME}'
              trigger_prototypes:
                - uuid: 528fb94feb5e45a689bb9a775f93990d
                  expression: 'min(/Custom - Windows by Zabbix agent - GodFather/service.info["{#SERVICE.NAME}",state],#3)<>0'
                  name: 'Windows: "{#SERVICE.NAME}" ({#SERVICE.DISPLAYNAME}) Não esta Running'
                  priority: AVERAGE
                  tags:
                    - tag: scope
                      value: notice
        - uuid: 89e8320c4d6e4d15bd740dd76a907fe0
          name: 'Mounted filesystem discovery'
          type: DEPENDENT
          key: vfs.fs.dependent.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#FSDRIVETYPE}'
                value: '{$VFS.FS.FSDRIVETYPE.MATCHES}'
                formulaid: A
              - macro: '{#FSDRIVETYPE}'
                value: '{$VFS.FS.FSDRIVETYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: C
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.MATCHES}'
                formulaid: E
              - macro: '{#FSTYPE}'
                value: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
          description: 'Discovery of filesystems of different types.'
          item_prototypes:
            - uuid: 114122b98f9647cf9ebafb18a0072da1
              name: 'FS [{#FSLABEL}({#FSNAME})]: Space: Available'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},free]'
              delay: '0'
              units: B
              description: 'Available storage space expressed in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.free
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: ba82c18e617a41d88027520bfb9f5b96
              name: 'FS [{#FSLABEL}({#FSNAME})]: Space: Used, in %'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},pused]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: 'Calculated as the percentage of currently used space compared to the maximum available space.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.pused
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: e50217cda0d943a2b0bdd581fe40128c
              name: 'FS [{#FSLABEL}({#FSNAME})]: Remaining time to reach 100%'
              type: CALCULATED
              key: 'vfs.fs.dependent.size[{#FSNAME},timeleft]'
              delay: 1h
              value_type: FLOAT
              params: 'timeleft(//vfs.fs.dependent.size[{#FSNAME},pused],15d,100)'
              trigger_prototypes:
                - uuid: f9684d9d42b740c4a67e562aaa27b5cf
                  expression: 'last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},timeleft])<1'
                  name: 'Windows: FS [{#FSLABEL}({#FSNAME})]: Uso de disco crítico: Menos de 1 dia para 100%'
                  priority: HIGH
                - uuid: f8538680d3ff428f8b100f2314fa3132
                  expression: 'last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},timeleft])<7'
                  name: 'Windows: FS [{#FSLABEL}({#FSNAME})]: Uso de disco crítico: Menos de 7 dias para 100%'
                  priority: AVERAGE
            - uuid: a15c0210fdc0404aaa282344485af664
              name: 'FS [{#FSLABEL}({#FSNAME})]: Space: Total'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},total]'
              delay: '0'
              units: B
              description: 'Total space expressed in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.total
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: 2a99c2e7e6724ce79438a6491c13b355
              name: 'FS [{#FSLABEL}({#FSNAME})]: Space: Used'
              type: DEPENDENT
              key: 'vfs.fs.dependent.size[{#FSNAME},used]'
              delay: '0'
              units: B
              description: 'Used storage expressed in bytes.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.bytes.used
              master_item:
                key: 'vfs.fs.dependent[{#FSNAME},data]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
            - uuid: 022a3d9fe251477fba681ed008a9ce7a
              name: 'FS [{#FSLABEL}({#FSNAME})]: Get data'
              type: DEPENDENT
              key: 'vfs.fs.dependent[{#FSNAME},data]'
              delay: '0'
              history: 1h
              value_type: TEXT
              trends: '0'
              description: 'Intermediate data of `{#FSNAME}` filesystem.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.fsname==''{#FSNAME}'')].first()'
              master_item:
                key: vfs.fs.get
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
                - tag: fstype
                  value: '{#FSTYPE}'
          trigger_prototypes:
            - uuid: b2b5a807fded427dab3693c53f6e7797
              expression: |
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},free])<50G and 
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},pused])>90
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},free])>50G and 
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},pused])<90
              name: 'Windows: FS [{#FSLABEL}({#FSNAME})]: Uso de disco crítico: acima de 90% e menos de 50GB livre'
              priority: AVERAGE
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: capacity
            - uuid: 16d38ac177b04907a2c8bc0e1b489c21
              expression: |
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},free])<25G and 
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},pused])>95
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},free])>25G and 
                last(/Custom - Windows by Zabbix agent - GodFather/vfs.fs.dependent.size[{#FSNAME},pused])<95
              name: 'Windows: FS [{#FSLABEL}({#FSNAME})]: Uso de disco crítico: acima de 95% e menos de 25GB livre'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: capacity
          graph_prototypes:
            - uuid: d668971a02b1412d9901753efe95d5f2
              name: 'FS [{#FSLABEL}({#FSNAME})]: Space usage graph, in %'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: FILLED_REGION
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'vfs.fs.dependent.size[{#FSNAME},pused]'
            - uuid: f11b57e879804532ab7bc0130a9bab9c
              name: 'FS [{#FSLABEL}({#FSNAME})]: Space utilization chart'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: '787878'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'vfs.fs.dependent.size[{#FSNAME},total]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: LAST
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'vfs.fs.dependent.size[{#FSNAME},used]'
                - sortorder: '2'
                  color: 199C09
                  calc_fnc: LAST
                  item:
                    host: 'Custom - Windows by Zabbix agent - GodFather'
                    key: 'vfs.fs.dependent.size[{#FSNAME},free]'
          master_item:
            key: vfs.fs.get
          lld_macro_paths:
            - lld_macro: '{#FSDRIVETYPE}'
              path: $.fsdrivetype
            - lld_macro: '{#FSLABEL}'
              path: $.fslabel
            - lld_macro: '{#FSNAME}'
              path: $.fsname
            - lld_macro: '{#FSTYPE}'
              path: $.fstype
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var filesystems = JSON.parse(value);
                  
                  result = filesystems.map(function (filesystem) {
                  	return {
                  		'fsname': filesystem.fsname,
                  		'fstype': filesystem.fstype,
                  		'fslabel': filesystem.fslabel,
                  		'fsdrivetype': filesystem.fsdrivetype
                  	};
                  });
                  
                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: os
        - tag: target
          value: windows
      macros:
        - macro: '{$AGENT.TIMEOUT}'
          value: 3m
          description: 'Timeout after which agent is considered unavailable. Works only for agents reachable from Zabbix server/proxy (passive mode).'
        - macro: '{$CPU.INTERRUPT.CRIT.MAX}'
          value: '50'
          description: 'The critical threshold of the % Interrupt Time counter.'
        - macro: '{$CPU.PRIV.CRIT.MAX}'
          value: '30'
          description: 'The threshold of the % Privileged Time counter.'
        - macro: '{$CPU.QUEUE.CRIT.MAX}'
          value: '3'
          description: 'The threshold of the Processor Queue Length counter.'
        - macro: '{$CPU.UTIL.CRIT}'
          value: '95'
          description: 'The critical threshold of the CPU utilization expressed in %.'
        - macro: '{$CPU.UTIL.WARN}'
          value: '90'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'Warning threshold of error packet rate. Can be used with interface name as context.'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
          description: 'Used as a threshold in the interface utilization trigger.'
        - macro: '{$IFCONTROL}'
          value: '1'
          description: 'Macro for the interface operational state for the "link down" trigger. Can be used with interface name as context.'
        - macro: '{$MEM.PAGE_SEC.CRIT.MAX}'
          value: '1000'
          description: 'The warning threshold of the Memory Pages/sec counter.'
        - macro: '{$MEM.PAGE_TABLE_CRIT.MIN}'
          value: '5000'
          description: 'The warning threshold of the Free System Page Table Entries counter.'
        - macro: '{$MEMORY.UTIL.MAX}'
          value: '95'
          description: 'The warning threshold of the Memory util item.'
        - macro: '{$MEMORY.UTIL.WARN}'
          value: '90'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_THIS
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_THIS
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '.*'
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: Miniport|Virtual|Teredo|Kernel|Loopback|Bluetooth|HTTPS|6to4|QoS|Layer
          description: 'Used in Network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SERVICE.NAME.MATCHES}'
          value: '^.*$'
          description: 'Used in Service discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SERVICE.NAME.NOT_MATCHES}'
          value: '^(?:RemoteRegistry|MMCSS|gupdate|SysmonLog|clr_optimization_v.+|sppsvc|gpsvc|Pml Driver HPZ12|Net Driver HPZ12|RasMan+|HealthService+|FactoryTalk+|FTAEWebService+|fdPHost+|pishutev+|Sysmon64+|SgrmBroker+|SWSEUMAgentSvc+|SolarWindsCertificateManagementService+|MapsBroker|IntelAudioService|Intel\(R\) TPM Provisioning Service|dbupdate|DoSvc|CDPUserSvc_.+|WpnUserService_.+|OneSyncSvc_.+|WbioSrvc|BITS|tiledatamodelsvc|GISvc|ShellHWDetection|TrustedInstaller|TabletInputService|CDPSvc|wuauserv|edgeupdate|cbdhsvc_.+)$'
          description: 'Used in Service discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SERVICE.STARTUPNAME.MATCHES}'
          value: '^(?:automatic|automatic delayed)$'
          description: 'Used in Service discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SERVICE.STARTUPNAME.NOT_MATCHES}'
          value: '^(?:manual|disabled)$'
          description: 'Used in Service discovery. Can be overridden on the host or linked template level.'
        - macro: '{$SWAP.PFREE.MIN.WARN}'
          value: '20'
          description: 'The warning threshold of the minimum free swap.'
        - macro: '{$SYSTEM.FUZZYTIME.MAX}'
          value: 300s
          description: 'The upper threshold for difference of system time.'
        - macro: '{$SYSTEM.FUZZYTIME.MIN}'
          value: 10s
          description: 'The lower threshold for difference of system time. Used in recovery expression to avoid trigger flapping.'
        - macro: '{$TIME}'
          value: 1m
        - macro: '{$VFS.DEV.DEVNAME.MATCHES}'
          value: '.*'
          description: 'Used in physical disk discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          value: _Total
          description: 'Used in physical disk discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.DEV.READ.AWAIT.WARN}'
          value: '0.02'
          description: 'Disk read average response time (in s) before the trigger fires.'
        - macro: '{$VFS.DEV.UTIL.MAX.WARN}'
          value: '95'
          description: 'The warning threshold of disk time utilization in percent.'
        - macro: '{$VFS.DEV.WRITE.AWAIT.WARN}'
          value: '0.02'
          description: 'Disk write average response time (in s) before the trigger fires.'
        - macro: '{$VFS.FS.FSDRIVETYPE.MATCHES}'
          value: fixed
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSDRIVETYPE.NOT_MATCHES}'
          value: ^\s$
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: '.*'
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: '^(?:/dev|/sys|/run|/proc|.+/shm$)'
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSTYPE.MATCHES}'
          value: '.*'
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSTYPE.NOT_MATCHES}'
          value: ^\s$
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '95'
          description: 'The critical threshold of the filesystem utilization.'
        - macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '90'
          description: 'The warning threshold of the filesystem utilization.'
      dashboards:
        - uuid: 4f207adcd96e4da4890cf99291d73ad2
          name: 'VM by zabbix agent'
          pages:
            - name: Resumo
              widgets:
                - type: tophosts
                  width: '72'
                  hide_header: 'YES'
                  fields:
                    - type: INTEGER
                      name: columns.0.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.0.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.0.data
                      value: '1'
                    - type: INTEGER
                      name: columns.0.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.0.display
                      value: '1'
                    - type: INTEGER
                      name: columns.0.history
                      value: '1'
                    - type: STRING
                      name: columns.0.item
                      value: 'Total memory'
                    - type: STRING
                      name: columns.0.name
                      value: 'Memoria total'
                    - type: INTEGER
                      name: columns.1.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.1.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.1.data
                      value: '1'
                    - type: INTEGER
                      name: columns.1.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.1.display
                      value: '1'
                    - type: INTEGER
                      name: columns.1.history
                      value: '1'
                    - type: STRING
                      name: columns.1.item
                      value: 'Used memory'
                    - type: STRING
                      name: columns.1.name
                      value: Memoria
                    - type: INTEGER
                      name: columns.2.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.2.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.2.data
                      value: '1'
                    - type: INTEGER
                      name: columns.2.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.2.display
                      value: '1'
                    - type: INTEGER
                      name: columns.2.history
                      value: '1'
                    - type: STRING
                      name: columns.2.item
                      value: 'Number of cores'
                    - type: STRING
                      name: columns.2.name
                      value: 'Number CPU'
                    - type: INTEGER
                      name: columns.3.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.3.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.3.data
                      value: '1'
                    - type: INTEGER
                      name: columns.3.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.3.display
                      value: '1'
                    - type: INTEGER
                      name: columns.3.history
                      value: '1'
                    - type: STRING
                      name: columns.3.item
                      value: 'CPU utilization'
                    - type: STRING
                      name: columns.3.name
                      value: CPU
                    - type: INTEGER
                      name: columns.4.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.4.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.4.data
                      value: '1'
                    - type: INTEGER
                      name: columns.4.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.4.display
                      value: '1'
                    - type: INTEGER
                      name: columns.4.history
                      value: '1'
                    - type: STRING
                      name: columns.4.item
                      value: 'Zabbix agent ping'
                    - type: STRING
                      name: columns.4.name
                      value: 'Status Agent'
                    - type: INTEGER
                      name: columns.5.aggregate_function
                      value: '0'
                    - type: STRING
                      name: columns.5.base_color
                      value: ''
                    - type: INTEGER
                      name: columns.5.data
                      value: '1'
                    - type: INTEGER
                      name: columns.5.decimal_places
                      value: '2'
                    - type: INTEGER
                      name: columns.5.display
                      value: '1'
                    - type: INTEGER
                      name: columns.5.history
                      value: '1'
                    - type: STRING
                      name: columns.5.item
                      value: Uptime
                    - type: STRING
                      name: columns.5.name
                      value: Uptime
                    - type: STRING
                      name: reference
                      value: BMKVE
                - type: graphprototype
                  'y': '2'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                    - type: STRING
                      name: reference
                      value: JKFDH
            - name: Filesystems
              widgets:
                - type: graphprototype
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '3'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'FS [{#FSLABEL}({#FSNAME})]: Space utilization chart'
                    - type: STRING
                      name: reference
                      value: ZXOQN
                - type: graphprototype
                  'y': '5'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'FS [{#FSLABEL}({#FSNAME})]: Space usage graph, in %'
                    - type: STRING
                      name: reference
                      value: AEELY
            - name: 'System performance'
              widgets:
                - type: graph
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'Windows: CPU usage'
                    - type: STRING
                      name: reference
                      value: XMLNP
                - type: graph
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'Windows: Memory utilization'
                    - type: STRING
                      name: reference
                      value: EZEHT
                - type: graphprototype
                  'y': '10'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '3'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'FS [{#FSLABEL}({#FSNAME})]: Space utilization chart'
                    - type: STRING
                      name: reference
                      value: TNTGY
                - type: graphprototype
                  'y': '15'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: '{#DEVNAME}: Disk read/write rates'
                    - type: STRING
                      name: reference
                      value: OWDEN
                - type: graphprototype
                  'y': '20'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: '{#DEVNAME}: Disk utilization and queue'
                    - type: STRING
                      name: reference
                      value: TSRXX
                - type: graphprototype
                  'y': '25'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                    - type: STRING
                      name: reference
                      value: NRXWI
                - type: graph
                  x: '36'
                  width: '36'
                  height: '5'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        key: 'perf_counter_en["\System\Processor Queue Length"]'
                    - type: STRING
                      name: reference
                      value: GQCUX
                    - type: INTEGER
                      name: source_type
                      value: '1'
                - type: graph
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'Custom - Windows by Zabbix agent - GodFather'
                        name: 'Windows: Swap usage'
                    - type: STRING
                      name: reference
                      value: LYUCV
      valuemaps:
        - uuid: 19e917bcb34d497da9fc4ee13be16d2c
          name: 'Win32_NetworkAdapter::AdapterTypeId'
          mappings:
            - value: '0'
              newvalue: 'Ethernet 802.3'
            - value: '1'
              newvalue: 'Token Ring 802.5'
            - value: '2'
              newvalue: 'Fiber Distributed Data Interface (FDDI)'
            - value: '3'
              newvalue: 'Wide Area Network (WAN)'
            - value: '4'
              newvalue: LocalTalk
            - value: '5'
              newvalue: 'Ethernet using DIX header format'
            - value: '6'
              newvalue: ARCNET
            - value: '7'
              newvalue: 'ARCNET (878.2)'
            - value: '8'
              newvalue: ATM
            - value: '9'
              newvalue: Wireless
            - value: '10'
              newvalue: 'Infrared Wireless'
            - value: '11'
              newvalue: Bpc
            - value: '12'
              newvalue: CoWan
            - value: '13'
              newvalue: '1394'
        - uuid: 8fb63e910a05402f89e22239c1e4ea55
          name: 'Win32_NetworkAdapter::NetConnectionStatus'
          mappings:
            - value: '0'
              newvalue: Disconnected
            - value: '1'
              newvalue: Connecting
            - value: '2'
              newvalue: Connected
            - value: '3'
              newvalue: Disconnecting
            - value: '4'
              newvalue: 'Hardware Not Present'
            - value: '5'
              newvalue: 'Hardware Disabled'
            - value: '6'
              newvalue: 'Hardware Malfunction'
            - value: '7'
              newvalue: 'Media Disconnected'
            - value: '8'
              newvalue: Authenticating
            - value: '9'
              newvalue: 'Authentication Succeeded'
            - value: '10'
              newvalue: 'Authentication Failed'
            - value: '11'
              newvalue: 'Invalid Address'
            - value: '12'
              newvalue: 'Credentials Required'
        - uuid: b81c1dbfb18e4a84a7dadb9fb3b47bdf
          name: 'Windows service state'
          mappings:
            - value: '0'
              newvalue: Running
            - value: '1'
              newvalue: Paused
            - value: '2'
              newvalue: 'Start pending'
            - value: '3'
              newvalue: 'Pause pending'
            - value: '4'
              newvalue: 'Continue pending'
            - value: '5'
              newvalue: 'Stop pending'
            - value: '6'
              newvalue: Stopped
            - value: '7'
              newvalue: Unknown
            - value: '255'
              newvalue: 'No such service'
        - uuid: 1b533d97300c49e6ac1ab8efadc325e7
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
        - uuid: fce9b40a727040168dd040435a6ad297
          name: 'Zabbix agent ping status'
          mappings:
            - value: '1'
              newvalue: Up
  triggers:
    - uuid: e3d7d685c3244aa792af07f86080bc2a
      expression: 'min(/Custom - Windows by Zabbix agent - GodFather/perf_counter_en["\System\Processor Queue Length"],5m) - last(/Custom - Windows by Zabbix agent - GodFather/wmi.get[root/cimv2,"Select NumberOfLogicalProcessors from Win32_ComputerSystem"]) * 2 > {$CPU.QUEUE.CRIT.MAX}'
      name: 'Windows: CPU queue length is too high'
      event_name: 'Windows: CPU queue length is too high (over {$CPU.QUEUE.CRIT.MAX} for 5m)'
      status: DISABLED
      priority: WARNING
      description: 'The CPU Queue Length in the last 5 minutes exceeds `{$CPU.QUEUE.CRIT.MAX}`. According to actual observations, PQL should not exceed the number of cores * 2. To fine-tune the conditions, use the macro `{$CPU.QUEUE.CRIT.MAX }`.'
      tags:
        - tag: scope
          value: performance
    - uuid: 3fa85dfd27fb41378a524b2b5ef86707
      expression: 'max(/Custom - Windows by Zabbix agent - GodFather/system.swap.pfree,5m)<{$SWAP.PFREE.MIN.WARN} and last(/Custom - Windows by Zabbix agent - GodFather/system.swap.size[,total])>0'
      name: 'Windows: High swap space usage'
      event_name: 'Windows: High swap space usage (less than {$SWAP.PFREE.MIN.WARN}% free)'
      opdata: 'Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: WARNING
      description: 'This trigger is ignored, if there is no swap configured'
      tags:
        - tag: scope
          value: performance
  graphs:
    - uuid: 6ac2dd65d1cf42fdb6d13e7774de1b08
      name: 'Windows: CPU jumps'
      graph_items:
        - color: 199C0D
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: 'perf_counter_en["\System\Context Switches/sec"]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: 'perf_counter_en["\Processor Information(_total)\% Interrupt Time"]'
    - uuid: 0e93adfb7a9a461b8a8f43ece5e8f9c3
      name: 'Windows: CPU usage'
      type: STACKED
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - color: 199C0D
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: 'perf_counter_en["\Processor Information(_total)\% User Time"]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: 'perf_counter_en["\Processor Information(_total)\% Privileged Time"]'
    - uuid: b990b05000f0409da1b411cc47fa55d4
      name: 'Windows: CPU utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          calc_fnc: MAX
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: system.cpu.util
    - uuid: 1408cd56c16a4daeab44c29a36843e6e
      name: 'Windows: Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          calc_fnc: MAX
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: vm.memory.util
    - uuid: 22f3c8a4a2ee434db307e5ddc124f99f
      name: 'Windows: Swap usage'
      graph_items:
        - color: 199C0D
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: system.swap.free
        - sortorder: '1'
          color: F63100
          item:
            host: 'Custom - Windows by Zabbix agent - GodFather'
            key: 'system.swap.size[,total]'
